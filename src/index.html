<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>WebGPU-Notes</title>
    <style>
        body {
            margin: 0;
            padding: 30px;
            background-color: #333;
            color: #fff;
            font-family: Arial, sans-serif;
        }

        #content {
            margin: 0 auto;
            padding: 20px;
            max-width: 900px;
            background: #222;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        pre {
            overflow-x: auto;
            border-radius: 6px;
        }

        iframe {
            border: none;
            overflow: hidden;
            width: 400px;
            height: 300px;
        }

        a {
            display: inline-block;
            padding: 6px 12px;
            background-color: #4CAF50;
            color: white;
            border-radius: 4px;
            text-decoration: none;
            /* 去掉默认下划线 */
            transition: background 0.3s;
        }

        a:hover {
            background-color: #45a049;
        }
    </style>
    <!-- 引入 marked.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- 白天模式 -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/styles/default.min.css"> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/github.min.css"> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/atom-one-light.min.css"> -->
    <!-- 夜间模式 -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/monokai.min.css"> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/github-dark.min.css"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/atom-one-dark.min.css">
    <!-- 引入 highlight.js -->
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/highlight.min.js"></script>
    <!-- and it's easy to individually load additional languages -->
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/languages/go.min.js"></script>
</head>

<body>
    <div id="content"></div>
    <script>
        // 配置 marked 使用 highlight.js 
        marked.setOptions({
            highlight: function (code, lang) {
                // 如果指定了语言，尝试用对应的高亮 
                if (lang && hljs.getLanguage(lang)) {
                    return hljs.highlight(code, { language: lang }).value;
                }
                // 否则自动检测 
                return hljs.highlightAuto(code).value;
            }
        });
        // const renderer = new marked.Renderer();
        // // 重写 link 方法 
        // renderer.link = function (o) { return `<a href="${o.href}" target="_blank" rel="noopener noreferrer">${o.text}</a>`; };
        // // 使用自定义 renderer 
        // marked.setOptions({ renderer });
        function parseMarkdown(url = './docs/webgpu.md') {
            // 读取并渲染 md 文件
            fetch(url) // 这里换成你的 md 文件路径
                .then(response => response.text())
                .then(text => {
                    // 使用 marked 将 Markdown 转换为 HTML
                    document.getElementById('content').innerHTML = marked.parse(text);

                    // 对所有代码块执行高亮
                    document.querySelectorAll('pre code').forEach((block) => {
                        hljs.highlightElement(block);
                    });
                })
                .catch(err => console.error(err));
        }

        // 1. 定义路由表
        const routes = {
            '#/': './docs/webgpu.md',
            '#/1': './docs/details/1-Triangle.md',
        };

        // 2. 路由渲染函数
        function router() {
            const content = document.getElementById('content');
            // 获取当前的 hash，如果没有则默认跳转到首页
            const path = window.location.hash || '#/';
            const url = routes[path];
            // 根据 hash 渲染对应的 HTML
            content.innerHTML = parseMarkdown(url);
        }

        // 3. 监听 hash 变化
        window.addEventListener('hashchange', router);

        // 4. 页面首次加载时执行一次
        window.addEventListener('load', router);
    </script>
</body>

</html>